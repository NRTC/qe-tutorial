## تابع hse

برای اجرای این برنامه کافی است در  فایل اصلی دایرکتوری اسپرسو، input-dft را مطابق شکل 89 در قسمت سیستم  برنامه، خط 18 اضافه کنید. توجه داشته باشید کلیه input هایی که می‌توانید استفاده کنید درفایل  funct-f90 مطابق شکل 85 قرار دارد و استفاده از شبه پتانسیل hse در خط 28  الزامی است.

سه خط 19 تا  21  شکل 94برای ران hse  الزامی است در صورت عدم نوشتن از پیش فرض که شامل این سه خط است استفاده می‌شود.

```
14                       ntyp = 1,
15                     nbnd= 40,
16                    ecutwfc = 30 ,
17                    ecutrho = 300 ,
18    input_dft='hse', nqx1=4, nqx2=4, nqx3=1, 
19    exxdiv_treatment='gygi-baldereschi',
20    x_gamma_extrapolation = .true. ,
21
22                  occupations = 'fixed' ,
23 /
24  &electrons
25 /
26 ATOMIC_SPECIES
27 C    12.0107     C.pz-vbc.UPF
```

شکل 94 ویرایش ورودی hse

توجه کنید که با خروجی ران hse  می‌توان گاف انرژی و بند استراکچر را مطابق شکل که با استفاده از نقاط k1  تا kn که مرتبط با نقاط فضای وارون است برای هر نقطه تعدادی انرژی تعیین شده است \(خط 603 تا 609 \) تعیین کرد به قسمی که k  درمحور افقی و انرژی ها در محور عمودی باشند، با وصل کردن این نقاط بنداستراکچر بدست    می آید. همچنین k-point  ها باید به صورت outomatic باشند.

```
603         k =-0.3750 0.3750 0.1000 (  4582 PWs)   bands (ev):
604
605   -19.9470 -18.1979 -17.7486 -16.0700 -10.8393  -9.1562  -9.0146  -7.5921
606    -6.8522  -5.9829  -4.4611  -3.9808  -0.0955   0.8538   4.1371   4.8822
607     4.9063   5.2590   5.7059   6.1050   6.2804   6.7542   6.8074   7.5146
608     7.6687   8.0243   8.1619   8.4142   8.6175   8.7702   8.9960   9.2662
609     9.4562  10.1572  10.4358  10.6467  10.8118  11.0058  11.2890  11.4176
610
611     highest occupied, lowest unoccupied level (ev):    -3.6318   -1.3617
612
613 !    total energy              =     -67.41796914 Ry
614     Harris-Foulkes estimate   =     -67.41796932 Ry
615     estimated scf accuracy    <       0.00000031 Ry
```

شکل 95 قسمتی از خروجی hse  شامل انرژی کل

اگر نیاز به crystal-b   داشتید می‌توانید با روندی که توضیح داده شده است در شکل زیر مختصات مربوط به نقاط را پیدا کرده ودر برنامه ورودی برای مقادیر  k-point  ها قرار داد.

![](/assets/96.png)

شکل 96 یافتن مختصات نقاط crystal-b

