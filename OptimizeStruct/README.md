# بهینه کردن ساختار

در ادامه بهینه کردن قالب کلی فایل ورودی و پس از اینکه انرژی کات و کاپوینت را بهینه کردیم، برای اینکه بهترین حالت را  برای جایگزیده شدن اتم ها را در نظر بگیریم، می‌توان از دو دستور زیر استفاده کرد: relax و vc-relax  


1- relax 

برای بهینه کردن ساختار از دستور ریلکس استفاده می‌کنیم. هنگامی که این دستور را وارد می‌کنیم برنامه مکان اتم ها را جابه جا می‌کند تا مکانی را برای اتم ها در یک سلول واحد انتخاب شود که در آن نقطه کل سیستم کمترین مقدار خود را داشته باشد. دو روش برای بهینه سازی وجود دارد که ما در اینجا به توضیح relax می پردازیم. در واقع از نمودار سهمی rlax می‌توان خواص مکانیکی ماده را بدست آورد اماvc-rlax اینگونه نیست، دارای اجرای بسیار سنگین همراه با ، اطلاعاتatomic position و پارامتر شبکه \(celldm\)در خروجی است.

@@@@شکل تغییر جایگاه اتمی در سلول واحد برای یافتن پایین ترین انرژی

تفاوتی که بین این دستور باscfدارد این است که باید در فایل ورودی باید مدلی که یون ها از ان پیروی می‌کنند را نیز لحاظ کنیم. همانطور که قبلا اشاره کرده بودیم برنامه کوانتوم اسپرسو بر اساس شبه پتانسیل عمل می‌کند. تئوری شبه پتانسیل در حقیقت کل سیستم را به دو دسته الکترون ها و الکترون های مقید به هسته و خود هسته هستند تقسیم می‌کند. هنگامی که سیستم در حال ریلکس شدن است یون ها می‌توانند در جایگاه نهایی اتم ها نقش موثری داشته باشند. بنابراین دلیل لحاظ کردن مدل حرکت یون ها را لحاظ می‌کنیم که معمولا از یک قالب کلی تبعیت می‌کنند.این دستور را به سیستم با فایل ورودی با نام ریلکس انتقال می دهیم. تصویر زیر یک نمونه از فایل ورودی ریلکس برای سلول واحد دو اتمی گرافن را نمایش می دهد. همانطور که در تصویر مشاهده می‌شود تمام ورودی ها مانند فایلscf است که پیشتر توضیح داده شد و تنها نوع محسبات را باید در حالتrelax قرار داد و همچنین در بلوک چهارم که پس ازالکترون ها که با&IONS مشخص شده است مدل دینامیک یون ها را لحاظ کنیم. ما مدل دینامیکیion dynamics= 'bfgs' را انتخاب نموده ایم. سایر مدل های دینامیکی را می‌توانید از راهنمای نرم افزار پیدا کنید.

همانطور که گفتیم برای محاسبات ریلکسcalculation=relax قرار داده سپس\(celldm1\)را 1درصد 1 درصد به طور فشاری و کششی تغییر می دهیم تا به نقطه مطلوب که در آن حالت کمترین انرژی را داراست برسیم.

```
 &CONTROL
                 calculation = 'relax' ,
                 restart_mode = 'from_scratch' ,
                 outdir='/root/Desktop/out',
                 pseudo_dir = '/root/Desktop/ps', 
                 tprnfor   = .true.
                 tstress = .true.
/
 &SYSTEM
                       ibrav = 14,
                       celldm(1)=3.796797653 ,   
                       celldm(2)=1 ,
                       celldm(3)=11.250000000 ,
                       celldm(4)=0 ,
                       celldm(5)=0 ,
                       celldm(6)=-0.500000000 ,   
                       nat = 2,
                       ntyp = 2,
                    ecutwfc =80 ,
                    ecutrho = 800 ,
                occupations = 'fixed',
/
 &ELECTRONS
                  conv_thr = 1.D-6 ,
                  diago_full_acc = .TRUE.,
/
&IONS
                  ion_dynamics= 'bfgs',
                  upscale  = 100.d0,
                  pot_extrapolation = 'second_order',
                  wfc_extrapolation = 'second_order' ,
/
ATOMIC_SPECIES
B    10.811     b_pbe.upf
N    14.00674   n_pbe.upf
ATOMIC_POSITIONS (angstrom)
B    1.255733396641119        0.724999963449228                   0
N   -0.000003396641119        1.450000036550772                   0
K_POINTS {automatic}
12 12 1   0  0  0
```

شکل فایل ورودی ریلکس\*\*\*\*\*\*\*

