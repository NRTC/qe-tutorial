# اجرای کد جهت بدست آوردن انرژی کات و کاپوینت

در این محاسبه ecut  در فایل ورودی برابر 30 است. به عبارتی با اجرا کردن scf، در فایل خروجی تعداد زیادی انرژی بدست می آید که انرژی مورد توجه ما در فایل خروجی انرژی آخر است که با علامت تعجب مشخص می‌شود  مانند \(شکل 20\) .پس هر  scf دارای انرژی صحیح در خروجی می‌باشدکه همان انرژی کل است. انرژی کل با اجرای scf های متعدد که در آن ecut  در فایل ورودی ، متفاوت خواهد بود. حال با توجه به این ران های متفاوت و انرژی کات های متفاوت یک نمودار می کشیم جایی که این نمودار به خط صاف  میل می‌کند مانند شکل ،  مقدار انرژی کات بهینه ی متناسب با کل انرژی خروجی سیستم بدست می آید که در نمودار شکل 21عدد 55 انرژی کات است. انرژی کات دقیقا شعاع دایره  شکل 16می‌باشد.\(1RY=13.6058 ev\)

```
314
315          the Fermi energy is       -2.2383 ev
316
317 !        total energy                 =        -22.76882509 Ry
318          Harris-Foulkes estimste      =        -22.76882339 Ry
319          estimated scf accuracy       <          0.00000058 Ry
320
```

شکل 20 انرژی کل سیستم

![](/assets/21.jpg)![](/assets/21.jpg)![](/assets/210.jpg)

شکل 21 ecut  بر حسب انرژی  
پس از بدست آوردن انرژی کات بهینه، تعداد کاپوینت ها را به فاصله ای مثلا 2 افزایش می دهیم و اجرای برنامه همان scf  می‌باشد در خروجی این برنامه نیز انرژی کل مورد نظر می‌باشد و پس از ران های مختلف در ازای کاپوینت های مختلف نموداری مانند شکل 22 بدست خواهد آمد. همانند انرژی کات در جایی که شکل همگرا می‌شود را به عنوان کاپوینت مطلوب انتخاب می‌کنیم.

![](/assets/22.jpg)

شکل 22 انرژی بر حسب کاپوینت  
 فقط به این نکته توجه کنید که زمانی که کاپوینت ها را افزایش می‌دهیم مانند  شکلهای زیر زمان اجرای برنامه  جهت همگرایی با شیفت دادن به \(1 1 1\) افزایش می یابد\(شکل 25\).

```
#   grid    shift   energy(Ry)     inequiv. k-points   time(s)
   1 1 1    0 0 0   -14.59239650     1                   0.20
   2 2 2    0 0 0   -15.66198445     3                   0.25
   4 4 4    0 0 0   -15.83707680     8                   0.21
   8 8 8    0 0 0   -15.85079066    29                   0.56
  16 16 16  0 0 0   -15.85108168   145                   2.41
```

شکل 23 افزایش کاپوینت بدون شیفت

```
#   grid    shift   energy(Ry)     inequiv. k-points   time(s)
   1 1 1    1 1 1   -15.66368666     1                   0.10
   2 2 2    1 1 1   -15.83894845     2                   0.10
   4 4 4    1 1 1   -15.85087570    10                   0.22
   8 8 8    1 1 1   -15.85108292    60                   0.04
  16 16 16  1 1 1   -15.85108131   408                   6.88
```

شکل 24 افزایش کاپوینت با شیفت

![](/assets/25.png)![](/assets/25.png)

شکل 25 نمودار شیفت  کاپوینت

