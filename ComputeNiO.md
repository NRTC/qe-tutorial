
1.26- بررسی Nio 
حرکت کنید به سمت NiO_ldau . مطالعه فایل ورودی (run_NiO_r16_ucalc) برای محاسبه U در این مورد آموزنده است. برای این سیستم ما می خواهیم U را برای Ni و O بسنجیم. مسائل قابل توجه :
1 ) به طور رسمی دو نوع اتم نیکل وجود دارد ؛ هرچند آنها تنها برای داشتن مغناطش متضاد متفاوت هستند، به طوری که تنها یکی از آنها برآشفته خواهد شد. پاسخ به یک اختلال در ثانیه با استفاده از تقارن بین دو اسپین بدست می آید.
2) زمانیکه تخمین پاسخ اختلال روی اکسیژن یک محاسبه SCF جدید را اجرا می‌کند اکسیژن برآشفته به سلول واحد مبدا برمیگردد. این کار برای حفظ بیشترین تعداد ممکن از تقارن اجرا می‌شود.
3) اتمی که در آن اختلال اعمال می‌شود نوع متفاوتی از دیگران است که توسط PP یکسان توصیف می‌شود.
1.26.1- محاسبه scf
ابتدا دو فایل وروری داریم که محاسبات را بر اساس ni و o انجام می‌دهند و به ازای انها نیز دو فایل خروجی یکی به ازای ni و دیگری به ازای o داریم . این دو فایل در برخی موارد با یکدیگر تفاوت دارند ابتدا محاسبات را برای ni انجام داده سپس با یک شیفت مختصات اتمها را تغییر داده و محاسبات را برای o انجام می‌دهیم که این تغییرات به صورت زیر می‌باشد :
1- اختلاف در تعداد حالاتیست که برای starting _magnetization در نظر می گیریم 
برای ni داریم :

همچنین برای حالت o :
  

2- اختلاف در Atomic_species :
برای ni داریم: 
 
برای o داریم :




همانطور که مشاهده می‌کنید طبق دو حالتیکه در بالا مقایسه کردیم می‌توان گفت
برای محاسبه ni :
اتم (1) : ni1  _ اتم (2) : ni2  _ اتم (3) : ni3  _ اتم (4) :  o1
و برای محاسبه o :
اتم (1) : ni1  _ اتم (2) : ni2  _ اتم (3) : o1  _ اتم (4) :  o2
همچنین می‌توان نتیجه گرفت که طبق مشاهدات فوق محاسبات starting _magnetization
را فقط برای اتمهای ni در نظر میگیریم .

3- اختلاف دیگری که در محاسبات برای ni و o می‌توان بیان کرد اختلاف در بیان ATOMIC_POSITIONS ها است 
برای ni داریم :

برای o داریم :











که در اینجا نیز با مقایسه این دو حالت می‌توان گفت زمانیکه محاسبات را برای ni انجام می دهیم موقعیت اتمهای ni1 را صفر در نظر گرفته و موقعیت اتمهای دیگر ni یعنی ni2 و ni3 را تغییر می‌دهیم همچنین برای اتم o یک نوع  o1 در نظر میگیریم با موقعیت های مختلف ولی زمانی که محاسبات را برای o انجام می‌دهیم دو نوع اتم ni1 و ni2 در نظر میگیریم با موقعیت های مختلف همچنین دو نوع اتم o1 و o2 در نظر میگیریم که موقعیت اتم o1 را صفر قرار می‌دهیم ولی موقیت اتم های o2 را مختلف در نظر میگیریم . (میبینیم که در هر دو حالت تعداد هرکدام از اتمها نیز به تعداد اتمها در قسمت Atomic_species بستگی دارد).
پس از ران کردن هر دو برنامه برای هر کدام یک فایل خروجی داریم چیزی که در این فایل خروجی برای ما اهمیت دارد مقدار عددی ethr است که در آخرین iteration قرار دارد 


شکل 146 خروجی scf
این مقدار را به خاطر بسپارید.
حال برای هرکدام از محاسبات ni و o یک فایل ورودی جدید نوشته و مقدار عددی ethr را در diago_thr_init آن وارد می‌کنیم. 

شکل 147 ویرایش فایل ورودی

سپس عبارت جدید Hubbard_alpha در فایل های فوق وارد کرده و محاسبات را به ازای مقادیر مختلف آلفا (0.15 _ 0.07 _ 0.0 _ 0.07- _ 0.15- ) برای آن انجام می‌دهیم . این فایل نیز در هر دو محاسبه ni و o با یکدیگر متفاوت هستند . که در اینجا به تفاوت بین آنها اشاره می‌کنیم :
برای محاسبه ni مولفه Hubbard_alpha را فقط برای یکی از اتمهای ni وارد می‌کنیم در واقع برای همان ni1که موقعیت اتمهای آنرا صفر در نظر گرفته بودیم :


برای محاسبه o مولفه Hubbard_alpha را فقط برای یکی از اتمهای o وارد می‌کنیم در واقع برای همان o1که موقعیت اتمهای آنرا صفر در نظر گرفته بودیم :


پس از نوشتن و اجرای صحیح محاسبات به نتایجی از فایلهای خروجی نیازمندیم که این نتایج شامل مقدار عددی (Tr[ns(na)]  (up, down, total ) برای 16 اتم موجود به ازای هر کدام از مقادیر Hubbard_alpha که به صورت جداگانه ران کردیم برای هر دو محاسبه ni و o می‌باشد. البته لازم به ذکر است که این اطلاعات را از iteraction #1 و End of self-consistent calculation استخراج می‌کنیم.
سپس برای دسته بندی آنها فایلهایی به صورت زیر نامگذاری می‌کنیم :
برای اتمهای ni  : 
 1-dn0. Number of atom. da. 1 
2-dn. Number of atom. da. 1	  	 
برای اتمهای o : 
		 1-dn0. Number of atom. da. 9 
2-dn. Number of atom. da. 9		 
این مقادیر را برای فایل های حالت 1 از iteraction #1  به صورت زیر حاصل می‌شود:

شکل 148 iteration 1 فایل خروجی scf

و برای فایل های حالت 2 از End of self-consistent calculation به صورت زیر حاصل می‌شود :


شکل 149 End of self-consistent calculation  فایل خروجی scf
بنابر این با یک دسته بندی صحیح می‌توان به راحتی تعیین کرد که برای مثال مقدار عددی مربوط به اتم شماره یک ni با مقدار hubbard_alpha برابر 0.07 چند است .
حال برای اجرای محاسبات U آماده‌ایم .

1.26.2- محاسبه grepnalfa_nio_r16
در اینجا نیز روی فایل grepnalfa_nio_r16 تغییرات لازمه را ایجاد کرده سپس آن‌را اجرا کرده ،در نتیجه فایل های dn.at.da.1.dat , dn0.at.da.1.dat , dn.at.da.9.dat , dn0.at.da.9.dat و file.nio.r16 ایجاد می‌شود.  

1.26.3- محاسبه resp_mat
از آنجایی‌که فایل r.x را قبلا تولید کردیم در نتیجه می‌توان در اینجا فایل resp_mat را اجرا کرد.
در Ucalc / فایل ورودی resp_mat.in را به صورت زیر درنظر بگیرید:
&input_mat	
# تعداد اتمهایی که برای محاسبه U به کار میرود              ntyp=2                                           
# تعداد اتمهای Ni                                                                                          na(1) = 8
#تعداد اتمهای O                                                                                           na(2) = 8              
nalfa = 5	# تعداد آلفاهایی که درنظر می‌گیریم.
magn = .true.          
filepos = 'pos_nio_r16'

# مرتبه species باید یکسان باشد با فایل  pos_nio_r16 زیرا ما می خواهیم اسپین نیکل را مشخص کنیم (فایل pos_nio_r16 را ببینید)  
back = 'no'
filednda = 'file.nio.r16'
n1 = 5
n2 = 5
n3 = 5
&end
pos_nio_r16 باید به صورت زیر باشد


همانطور که مشاهده می‌کنیم در ستون آخر فایل pos_nio_r16 اعداد 1 ، 1- و 0 را مشاهده می‌کنیم که : (1) برای اسپین بالای  ni ، (1-) برای اسپین پایین ni ، (0) برای اسپین غیرقطبیده شده o
توجه داشته باشید که اتم های O اسپین 0 دارند (آنها غیرمغناطیسی هستند) در حالی که اتم نیکل 1 یا 1- است. 
پس از اجرای فایل resp_mat.in فایل Umat.out حاصل می‌شود. 
در فایل Umat.out می‌توان برای ni و o مقادیر زیر را جستجو کرد:
Number of atom  ,  U1 

در اینجا نیز اسکریپت  ucalc_sc1_pbe.j همه عملیات لازم برای محاسبه U را به طورخودکار انجام می‌دهد.
 


